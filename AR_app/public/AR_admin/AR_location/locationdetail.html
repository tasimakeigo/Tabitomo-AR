<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>モデル詳細情報</title>
    <link rel="stylesheet" href="static/location.css">
</head>

<body>
    <header>
        <h1><a href="menu.html">管理者システム - モデル情報 -</a></h1>
        <ul>
            <li>
                <p>ユーザー名: </p>
            </li>
            <li id="logout">
                <a href="">ログアウト</a>
            </li>
        </ul>
    </header>

    <main>
        <button class="add-btn">新規モデル追加</button>
        <div class="sideber">
            <div class="sideber-container">
                <a href="../menu.html"><button>メニュー</button></a>
                <a href="../AR_user/user.html"><button>管理者情報</button></a>
                <a href="../AR_marker/marker.html"><button>マーカー管理</button></a>
                <a href="../AR_model/modellist.html"><button>3Dモデル</button></a>
                <a href="../AR_napisy/napisy.html"><button>字幕管理</button></a>
                <a href="../AR_sound/sound.html"><button>音声管理</button></a>
                <a href="../AR_map/map.html"><button>マップ管理</button></a>
            </div>
        </div>
        <div>
        </div>
        <div class="container">
            <div id="location-details"></div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const locationid = urlParams.get('locationid');
            const locationname = urlParams.get('locationname');

            if (locationid) {
                // モデル情報を取得して表示
                fetch(`/locationdetail?locationid=${locationid}`)
                    .then(response => response.json())
                    .then(data => {
                        const locationDetails = document.getElementById('location-details');
                        let detailsHtml = `<h2>場所: ${locationname}</h2>`;

                        data.forEach(model => {
                            detailsHtml += `
                                <p>
                                    <strong>モデル名:</strong> ${model.mdlname}<br>
                                    <strong>画像:</strong> <img src="${model.mdlimage}" alt="${model.mdlimage}" width="200"><br>
                                    <strong>マーカー名:</strong> ${model.mkname}<br>
                                    <strong>パターン:</strong> ${model.patt}<br>
                                    <strong>マーカー画像:</strong> <img src="${model.mkimage}" alt="${model.mkname}" width="200"><br>
                                    <strong>音声ファイル:</strong> ${model.mdlsound}<br>
                                    <strong>モデルテキスト:</strong> ${model.mdltext}
                                </p>
                                <button class="edit-btn" data-mdlid="${model.mdlid}">編集</button>
                                <button class="delete-btn" data-mdlid="${model.mdlid}">削除</button>
                            `;
                        });

                        locationDetails.innerHTML = detailsHtml;

                        // 編集ボタンのイベントリスナー追加
                        document.querySelectorAll('.edit-btn').forEach(button => {
                            button.addEventListener('click', function () {
                                const mdlid = this.dataset.mdlid;
                                window.location.href = `/AR_admin/AR_location/modeledit.html?mdlid=${encodeURIComponent(mdlid)}`;
                            });
                        });

                        // 削除ボタンのイベントリスナー追加
                        document.querySelectorAll('.delete-btn').forEach(button => {
                            button.addEventListener('click', function () {
                                const mdlid = this.dataset.mdlid;
                                window.location.href = `/AR_admin/AR_location/modeldel.html?mdlid=${encodeURIComponent(mdlid)}`;
                            });
                        });
                    })
                    .catch(error => {
                        console.error('モデル情報の取得中にエラーが発生しました:', error);
                        alert('モデル情報の取得に失敗しました。');
                    });

                // 新規モデル追加ボタンのイベントリスナー追加
                document.querySelector('.add-btn').addEventListener('click', function () {
                    window.location.href = `/AR_admin/AR_location/modeladd.html?locationid=${encodeURIComponent(locationid)}`;
                });
            } else {
                alert('場所IDが指定されていません。');
            }
        });
    </script>
</body>

</html>
